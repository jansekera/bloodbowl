import{P as S,T as k,S as I,G as T}from"./ScoreBoard.js";function b(){return{matchId:0,half:1,activeTeam:"home",phase:"play",homeTeam:{teamId:1,name:"Reikland Reavers",raceName:"Human",side:"home",score:1,rerolls:3,rerollUsedThisTurn:!1,turnNumber:3,blitzUsedThisTurn:!1,passUsedThisTurn:!1,foulUsedThisTurn:!1},awayTeam:{teamId:2,name:"Gouged Eye",raceName:"Orc",side:"away",score:0,rerolls:2,rerollUsedThisTurn:!1,turnNumber:3,blitzUsedThisTurn:!1,passUsedThisTurn:!1,foulUsedThisTurn:!1},players:[{id:1,playerId:1,name:"Karl",number:1,positionalName:"Lineman",stats:{movement:6,strength:3,agility:3,armour:8},skills:[],state:"standing",position:{x:12,y:5},hasMoved:!1,hasActed:!1,movementRemaining:6,teamSide:"home"},{id:2,playerId:2,name:"Franz",number:2,positionalName:"Lineman",stats:{movement:6,strength:3,agility:3,armour:8},skills:[],state:"standing",position:{x:12,y:7},hasMoved:!1,hasActed:!1,movementRemaining:6,teamSide:"home"},{id:3,playerId:3,name:"Heinrich",number:3,positionalName:"Lineman",stats:{movement:6,strength:3,agility:3,armour:8},skills:[],state:"standing",position:{x:12,y:9},hasMoved:!1,hasActed:!1,movementRemaining:6,teamSide:"home"},{id:4,playerId:4,name:"Griff",number:7,positionalName:"Blitzer",stats:{movement:7,strength:3,agility:3,armour:8},skills:["Block"],state:"standing",position:{x:10,y:4},hasMoved:!0,hasActed:!1,movementRemaining:0,teamSide:"home"},{id:5,playerId:5,name:"Wolfgang",number:8,positionalName:"Blitzer",stats:{movement:7,strength:3,agility:3,armour:8},skills:["Block"],state:"standing",position:{x:10,y:10},hasMoved:!1,hasActed:!1,movementRemaining:7,teamSide:"home"},{id:6,playerId:6,name:"Hans",number:9,positionalName:"Catcher",stats:{movement:8,strength:2,agility:3,armour:7},skills:["Dodge","Catch"],state:"standing",position:{x:8,y:2},hasMoved:!1,hasActed:!1,movementRemaining:8,teamSide:"home"},{id:7,playerId:7,name:"Otto",number:10,positionalName:"Thrower",stats:{movement:6,strength:3,agility:3,armour:8},skills:["Sure Hands"],state:"standing",position:{x:7,y:7},hasMoved:!1,hasActed:!1,movementRemaining:6,teamSide:"home"},{id:8,playerId:8,name:"Fritz",number:4,positionalName:"Lineman",stats:{movement:6,strength:3,agility:3,armour:8},skills:[],state:"prone",position:{x:11,y:6},hasMoved:!1,hasActed:!1,movementRemaining:0,teamSide:"home"},{id:9,playerId:9,name:"Grishnak",number:1,positionalName:"Lineman",stats:{movement:5,strength:3,agility:3,armour:9},skills:[],state:"standing",position:{x:13,y:5},hasMoved:!1,hasActed:!1,movementRemaining:5,teamSide:"away"},{id:10,playerId:10,name:"Ugluk",number:2,positionalName:"Lineman",stats:{movement:5,strength:3,agility:3,armour:9},skills:[],state:"standing",position:{x:13,y:7},hasMoved:!1,hasActed:!1,movementRemaining:5,teamSide:"away"},{id:11,playerId:11,name:"Bolg",number:3,positionalName:"Lineman",stats:{movement:5,strength:3,agility:3,armour:9},skills:[],state:"standing",position:{x:13,y:9},hasMoved:!1,hasActed:!1,movementRemaining:5,teamSide:"away"},{id:12,playerId:12,name:"Varag",number:5,positionalName:"Blitzer",stats:{movement:6,strength:3,agility:3,armour:9},skills:["Block"],state:"standing",position:{x:15,y:6},hasMoved:!1,hasActed:!1,movementRemaining:6,teamSide:"away"},{id:13,playerId:13,name:"Azog",number:6,positionalName:"Blitzer",stats:{movement:6,strength:3,agility:3,armour:9},skills:["Block"],state:"standing",position:{x:15,y:8},hasMoved:!1,hasActed:!1,movementRemaining:6,teamSide:"away"},{id:14,playerId:14,name:"Muzgash",number:7,positionalName:"Black Orc",stats:{movement:4,strength:4,agility:2,armour:9},skills:[],state:"standing",position:{x:14,y:4},hasMoved:!1,hasActed:!1,movementRemaining:4,teamSide:"away"},{id:15,playerId:15,name:"Gorgut",number:8,positionalName:"Black Orc",stats:{movement:4,strength:4,agility:2,armour:9},skills:[],state:"standing",position:{x:14,y:10},hasMoved:!1,hasActed:!1,movementRemaining:4,teamSide:"away"},{id:16,playerId:16,name:"Snaglak",number:4,positionalName:"Lineman",stats:{movement:5,strength:3,agility:3,armour:9},skills:[],state:"stunned",position:{x:13,y:11},hasMoved:!1,hasActed:!1,movementRemaining:0,teamSide:"away"}],ball:{position:{x:7,y:7},isHeld:!0,carrierId:7},turnoverPending:!1,kickingTeam:null,aiTeam:null,weather:"nice"}}function f(){const s=document.getElementById("pitch-canvas"),m=document.getElementById("match-container");if(!s||!m){console.error("Missing #pitch-canvas or #match-container");return}const y=32,r=new S(s,y),t=new T,i=new k(m),h=new I(m);t.onChange(()=>{var n;const e=t.getGameState();if(!e)return;const a=t.getSelection();if(r.render(e.players,e.ball,a.validTargets,a.selectedPlayerId,a.hoveredCell),(n=e.ball)!=null&&n.isHeld&&e.ball.carrierId){const o=t.getPlayerById(e.ball.carrierId);o!=null&&o.position&&r.drawBallOnPlayer(o.position)}h.update(e)}),s.addEventListener("mousemove",e=>{const a=s.getBoundingClientRect(),n=s.width/a.width,o=s.height/a.height,u=(e.clientX-a.left)*n,p=(e.clientY-a.top)*o,d=r.geometry.pixelToGrid(u,p);if(t.setHoveredCell(d),d){const g=t.getPlayerAtPosition(d);g?i.show(g,e.clientX-m.getBoundingClientRect().left,e.clientY-m.getBoundingClientRect().top):i.hide()}else i.hide()}),s.addEventListener("mouseleave",()=>{i.hide(),t.setHoveredCell(null)}),s.addEventListener("click",e=>{const a=s.getBoundingClientRect(),n=s.width/a.width,o=s.height/a.height,u=(e.clientX-a.left)*n,p=(e.clientY-a.top)*o,d=r.geometry.pixelToGrid(u,p);if(!d)return;const g=t.getSelection(),l=t.getPlayerAtPosition(d);if(l&&l.teamSide==="home"){if(g.selectedPlayerId===l.id)t.clearSelection(),t.setHoveredCell(null);else if(t.selectPlayer(l.id),l.state==="standing"&&!l.hasMoved){const v=x(l.position,l.stats.movement,r.geometry,t.getGameState().players);t.setValidTargets("move",v)}}else g.selectedPlayerId!==null&&(t.clearSelection(),t.setHoveredCell(d))});const c=b();t.setGameState(c)}function x(s,m,y,r){const t=new Set;for(const e of r)e.position&&t.add(`${e.position.x},${e.position.y}`);const i=new Set,h=[],c=[{...s,dist:0}];for(i.add(`${s.x},${s.y}`);c.length>0;){const e=c.shift();if(e.dist>0&&!t.has(`${e.x},${e.y}`)&&h.push({x:e.x,y:e.y}),!(e.dist>=m))for(const a of y.getAdjacentPositions(e)){const n=`${a.x},${a.y}`;!i.has(n)&&!t.has(n)&&(i.add(n),c.push({...a,dist:e.dist+1}))}}return h}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",f):f();
